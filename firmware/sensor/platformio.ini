; Waggle Sensor Node — ESP32 light-sleep sensor beacon with bee counting
; Reads HX711 (weight), BME280 (env), battery ADC, then transmits
; a 48-byte ESP-NOW payload to the bridge and returns to light sleep.
; Bee counter ISRs remain active during light sleep.

[env:sensor]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
lib_deps =
    bogde/HX711@^0.7.5
    adafruit/Adafruit BME280 Library@^2.2.4
    adafruit/Adafruit Unified Sensor@^1.1.14
test_framework = unity
build_flags =
    -DCORE_DEBUG_LEVEL=3

; Native test environment — runs payload and bee counter unit tests on host
; Only compiles bee_counter.cpp from src/ (other files need Arduino).
; The UNIT_TEST define guards out ISR/GPIO code in bee_counter.cpp.
[env:native]
platform = native
test_framework = unity
test_build_src = yes
build_src_filter = -<*> +<bee_counter.cpp>
build_flags =
    -DUNIT_TEST
    -std=c++11
